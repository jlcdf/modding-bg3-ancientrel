Version 1
SubGoalCombiner SGC_AND
INITSECTION
// Store training dummy template
DB_AMP_TrainingDummyTemplate((GUIDSTRING)Training_Boy_9c617e39-19e4-4edc-8b0a-8ec3100e4300);
KBSECTION
// Track spawned training dummies
IF
EnteredLevel((CHARACTER)_Dummy, (ROOT)_Template, _)
AND
DB_AMP_TrainingDummyTemplate(_DummyTemplate)
AND
_Template == _DummyTemplate
THEN
DB_AMP_TrainingDummy(_Dummy);

// Remove dummy if player with buff damages non-dummy
IF
AttackedBy((GUIDSTRING)_Defender, (CHARACTER)_AttackerOwner, _, _, _, _, _)
AND
HasActiveStatus(_AttackerOwner, "TRAINING_ACTION", 1)
AND
IsCharacter(_Defender, 1)
AND
GetTemplate(_Defender, _Template)
AND
DB_AMP_TrainingDummyTemplate(_DummyTemplate)
AND
_Template != _DummyTemplate
AND
DB_AMP_TrainingDummy(_Dummy)
THEN
Die((CHARACTER)_Dummy, DEATHTYPE.Disintegrate, NULL_00000000-0000-0000-0000-000000000000, 0, 1, 0.0);
NOT DB_AMP_TrainingDummy(_Dummy);

// Clean up when dummy dies
IF
Died((CHARACTER)_Dummy)
AND
DB_AMP_TrainingDummy(_Dummy)
THEN
NOT DB_AMP_TrainingDummy(_Dummy);
EXITSECTION

ENDEXITSECTION
